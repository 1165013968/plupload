(function(a){function b(f,d){var c=0,g=0,e;f=f;d=d||document.body;e=f;while(e&&e!=d&&e.nodeType){c+=e.offsetLeft||0;g+=e.offsetTop||0;e=e.offsetParent}r=f.parentNode;while(e&&e!=d&&e.nodeType){c-=e.scrollLeft||0;g-=e.scrollTop||0;e=e.parentNode}return{x:c,y:g}}a.Html5Runtime=a.addRuntime("html5",{isSupported:function(){var c;if(window.XMLHttpRequest){c=new XMLHttpRequest();return !!(c.sendAsBinary||c.upload)}return false},init:function(f){var d,e,g,c={};d=document.getElementById(f.settings.browse_button);e=a.getPos(d);g=document.createElement("div");g.id=f.id+"_html5_container";a.extend(g.style,{position:"absolute",background:f.settings.html5_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",opacity:0});g.className="plupload_html5";document.body.appendChild(g);g.innerHTML='<input id="'+f.id+'_html5" style="width:100%;" type="file" '+(f.settings.multi_selection?'multiple="multiple"':"")+" />";f.bind("HTML5:PositionAtBrowseButton",function(h){var i,j;i=document.getElementById(f.settings.browse_button);j=a.getPos(i);a.extend(document.getElementById(f.id+"_html5_container").style,{top:j.y+"px",left:j.x+"px",width:i.offsetWidth+"px",height:i.offsetHeight+"px"})});f.bind("UploadFile",function(h,k){var l=new XMLHttpRequest(),j,i=h.settings.url;if(k.status==a.DONE||k.status==a.FAILED||h.state==a.STOPPED){return}if(j=l.upload){j.onload=function(){k.status=a.DONE;h.trigger("FileUploaded",k)};j.onprogress=function(m){k.loaded=m.loaded;h.trigger("UploadProgress",k)}}l.onreadystatechange=function(){if(l.readyState==4){k.status=a.DONE;k.loaded=k.size;h.trigger("UploadProgress",k);h.trigger("FileUploaded",k)}};l.open("post",i+(i.indexOf("?")==-1?"?":"&")+"name="+escape(k.target_name||k.name),true);l.setRequestHeader("Content-Type","application/octet-stream");if(l.sendAsBinary){l.sendAsBinary(c[k.id].getAsBinary())}else{l.send(c[k.id])}});document.getElementById(f.id+"_html5").onchange=function(){var j,h,k=[],l;for(h=0;h<this.files.length;h++){j=this.files[h];l=a.guid();c[l]=j;k.push(new a.File(l,j.fileName,j.fileSize))}f.trigger("FilesSelected",k);this.value=""};f.trigger("HTML5:PositionAtBrowseButton")}})})(plupload);