(function(){var f=0,c=[],g={},a={},h;function e(){this.returnValue=false}function b(){this.cancelBubble=true}(function(j){var k=j.split(/,/),l,n,m;for(l=0;l<k.length;l+=2){m=k[l+1].split(/ /);for(n=0;n<m.length;n++){a[m[n]]=k[l]}}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats,docx pptx xlsx,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/html,htm html xhtml,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/x-flv,flv,video/vnd.rn-realvideo,rv,text/plain,asc txt text diff log,application/octet-stream,exe");var d={STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,mimeTypes:a,extend:function(m){var k,l,j;for(j=1;j<arguments.length;j++){l=arguments[j];for(k in l){m[k]=l[k]}}return m},cleanName:function(j){var k,l;l=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(k=0;k<l.length;k+=2){j=j.replace(l[k],l[k+1])}j=j.replace(/\s+/g,"_");j=j.replace(/[^a-z0-9_\-\.]+/gi,"");return j},addRuntime:function(i,j){j.name=i;c[i]=j;c.push(j);return j},guid:function(){var j=new Date().getTime().toString(32),k;for(k=0;k<5;k++){j+=Math.floor(Math.random()*65535+f).toString(32)}return j},formatSize:function(i){if(i>1048576){return Math.round(i/1048576,1)+" MB"}if(i>1024){return Math.round(i/1024,1)+" KB"}return i+" b"},getPos:function(l,j){var i=0,m=0,k;l=l;j=j||document.body;k=l;while(k&&k!=j&&k.nodeType){i+=k.offsetLeft||0;m+=k.offsetTop||0;k=k.offsetParent}k=l.parentNode;while(k&&k!=j&&k.nodeType){i-=k.scrollLeft||0;m-=k.scrollTop||0;k=k.parentNode}return{x:i,y:m}},parseSize:function(i){var j;if(typeof(i)=="string"){i=/^([0-9]+)([mgk]+)$/.exec(i.toLowerCase().replace(/[^0-9mkg]/g,""));j=i[2];i=parseInt(i[1]);if(j=="g"){i*=1073741824}if(j=="m"){i*=1048576}if(j=="k"){i*=1024}}return i},xmlEncode:function(k){var j={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},i=/[<>&\"\']/g;return(this.xmlEncode=function(l){return l?(""+l).replace(i,function(m){return j[m]?"&"+j[m]+";":m}):l})(k)},toArray:function(l){var k,j=[];for(k=0;k<l.length;k++){j[k]=l[k]}return j},addI18n:function(i){return plipload.extend(g,i)},translate:function(i){return g[i]||i},addEvent:function(j,i,k){if(j.attachEvent){j.attachEvent("on"+i,function(){var l=window.event;if(!l.target){l.target=l.srcElement}l.preventDefault=e;l.stopPropagation=b;k(l)})}else{if(j.addEventListener){j.addEventListener(i,k,false)}}}};d.Uploader=function(k){var j={},n,m=[],o;n=new d.QueueProgress();k=d.extend({chunk_size:"1mb",max_file_size:"1gb",multi_selection:true,image_quality:90,filters:[{title:"Image files",extensions:"jpg,gif,png"}]},k);function l(){var p;if(this.state==d.STARTED&&o<m.length){p=m[o++];if(p.status==d.QUEUED){this.trigger("UploadFile",p)}else{l.call(this)}}else{this.stop()}}function i(){var p;n.reset();for(p=0;p<m.length;p++){n.size+=m[p].size;n.loaded+=m[p].loaded;if(m[p].status==d.DONE){n.uploaded++}else{if(m[p].status==d.FAILED){n.failed++}else{n.queued++}}}n.percent=n.size>0?Math.ceil(n.loaded/n.size*100):0}d.extend(this,{state:d.STOPPED,features:{},files:m,settings:k,total:n,id:d.guid(),init:function(){var u=this,v,r,q,t=0,s;k.page_url=k.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");if(!/^(\w+:\/\/|\/)/.test(k.url)){k.url=k.page_url+k.url}k.chunk_size=d.parseSize(k.chunk_size);k.max_file_size=d.parseSize(k.max_file_size);u.bind("FilesAdded",function(w,z){var y,x;for(y=0;y<z.length;y++){x=z[y];x.loaded=0;x.percent=0;if(z[y].size>k.max_file_size){x.status=d.FAILED}else{x.status=d.QUEUED}m.push(x)}u.trigger("QueueChanged");u.refresh()});u.bind("UploadProgress",function(w,x){if(x.status==d.QUEUED){x.status=d.UPLOADING}x.percent=x.size>0?Math.ceil(x.loaded/x.size*100):0;i()});u.bind("QueueChanged",i);u.bind("FileUploaded",function(w,x){x.status=d.DONE;w.trigger("UploadProgress",x);l.call(u)});if(k.runtimes){r=[];s=k.runtimes.split(/,/);for(v=0;v<s.length;v++){r.push(c[s[v]])}}else{r=c}function p(){var w=r[t++];if(w){w.init(u,function(x){if(x&&x.success){u.trigger("Init",{runtime:w.name});u.trigger("PostInit");u.refresh()}else{p()}})}}p()},refresh:function(){this.trigger("Refresh")},start:function(){if(this.state!=d.STARTED){o=0;this.state=d.STARTED;this.trigger("StateChanged");l.call(this)}},stop:function(){if(this.state!=d.STOPPED){this.state=d.STOPPED;this.trigger("StateChanged")}},getFile:function(q){var p;for(p=m.length-1;p>=0;p--){if(m[p].id===q){return m[p]}}},removeFile:function(q){var p;for(p=m.length-1;p>=0;p--){if(m[p].id===q.id){return this.splice(p,1)[0]}}},splice:function(r,p){var q;q=m.splice(r,p);this.trigger("FilesRemoved",q);this.trigger("QueueChanged");return q},trigger:function(q){var s=j[q.toLowerCase()],r,p;if(s){p=Array.prototype.slice.call(arguments);p[0]=this;for(r=0;r<s.length;r++){if(s[r].func.apply(s[r].scope,p)===false){return false}}}return true},bind:function(p,r,q){var s;p=p.toLowerCase();s=j[p]||[];s.push({func:r,scope:q||this});j[p]=s},unbind:function(p,r){var s=j[p.toLowerCase()],q;if(s){for(q=s.length-1;q>=0;q--){if(s[q].func===r){s.splice(q,1)}}}}})};d.File=function(l,j,k){var i=this;i.id=l;i.name=j;i.size=k;i.loaded=0;i.percent=0;i.status=0};d.Runtime=function(){this.init=function(i,j){}};d.QueueProgress=function(){var i=this;i.size=0;i.loaded=0;i.uploaded=0;i.failed=0;i.queued=0;i.percent=0;i.reset=function(){i.size=i.loaded=i.uploaded=i.failed=i.queued=i.percent=0}};d.runtimes={};window.plupload=d})();(function(b){var d={},c=true;function a(g,j,e,l,k){var f,h,i;h=google.gears.factory.create("beta.canvas");h.decode(g);scale=Math.min(j/h.width,e/h.height);if(scale<1){j=Math.round(h.width*scale);e=Math.round(h.height*scale)}else{j=h.width;e=h.height}h.resize(j,e);return h.encode(k,{quality:l/100})}b.runtimes.Gears=b.addRuntime("gears",{init:function(g,i){var h;if(!window.google||!google.gears){return i({success:false})}try{h=google.gears.factory.create("beta.desktop")}catch(e){return i({success:false})}function f(l){var k,j,m=[],n;for(j=0;j<l.length;j++){k=l[j];n=b.guid();d[n]=k.blob;m.push(new b.File(n,k.name,k.blob.length))}g.trigger("FilesAdded",m)}g.bind("PostInit",function(){var k=g.settings,j=document.getElementById(k.drop_element);if(j){b.addEvent(j,"dragover",function(l){l.preventDefault()});b.addEvent(j,"drop",function(m){var l=h.getDragData(m,"application/x-gears-files");if(l){f(l.files)}m.preventDefault()});j=0}b.addEvent(document.getElementById(k.browse_button),"click",function(p){var o=[],m,l,n;p.preventDefault();for(m=0;m<k.filters.length;m++){n=k.filters[m].extensions.split(",");for(l=0;l<n.length;l++){o.push("."+n[l])}}h.openFiles(f,{singleFile:!k.multi_selection,filter:o})})});g.bind("UploadFile",function(n,k){var r=0,o,l,m=0,q,p;q=n.settings.image_width;p=n.settings.image_height;l=n.settings.chunk_size;o=Math.ceil(k.size/l);if(/\.(png|jpg|jpeg)$/i.test(k.name)&&(q||p)){d[k.id]=a(d[k.id],q,p,n.settings.image_quality,/\.png$/i.test(k.name)?"image/png":"image/jpeg")}k.size=d[k.id].length;j();function j(){var s=n.settings.url,t,u;if(k.status==b.DONE||k.status==b.FAILED||n.state==b.STOPPED){return}u=Math.min(l,k.size-(r*l));t=google.gears.factory.create("beta.httprequest");t.open("POST",s+(s.indexOf("?")==-1?"?":"&")+"name="+escape(k.target_name||k.name)+"&chunk="+r+"&chunks="+o);t.setRequestHeader("Content-Disposition",'attachment; filename="'+k.name+'"');t.setRequestHeader("Content-Type","application/octet-stream");t.upload.onprogress=function(v){k.loaded=m+v.loaded;n.trigger("UploadProgress",k)};t.onreadystatechange=function(){var v;if(t.readyState==4){if(t.status==200){v={file:k,chunk:r,chunks:o,response:t.responseText};n.trigger("ChunkUploaded",v);if(v.cancelled){k.status=b.FAILED;n.trigger("FileUploaded",k);return}m+=u;if(++r>=o){k.status=b.DONE;n.trigger("FileUploaded",k)}else{j()}}else{n.trigger("UploadChunkError",{file:k,chunk:r,chunks:o,error:"Status: "+t.status})}}};if(r<o){t.send(d[k.id].slice(r*l,u))}}});g.features={dragdrop:c,jpgresize:c,pngresize:c,chunks:c};i({success:c})}})})(plupload);(function(b){var a={};function c(n){var p=false;var d=null;try{var j=null;try{j=new ActiveXObject("AgControl.AgControl");if(n==null){p=true}else{if(j.IsVersionSupported(n)){p=true}}j=null}catch(m){var k=navigator.plugins["Silverlight Plug-In"];if(k){if(n===null){p=true}else{var f=k.description;if(f==="1.0.30226.2"){f="2.0.30226.2"}var g=f.split(".");while(g.length>3){g.pop()}while(g.length<4){g.push(0)}var h=n.split(".");while(h.length>4){h.pop()}var o,i,l=0;do{o=parseInt(h[l]);i=parseInt(g[l]);l++}while(l<h.length&&o===i);if(o<=i&&!isNaN(o)){p=true}}}}}catch(m){p=false}return p}b.silverlight={trigger:function(h,e){var g=a[h],f,d;if(g){d=b.toArray(arguments).slice(1);d[0]="Silverlight:"+e;setTimeout(function(){g.trigger.apply(g,d)},0)}}};b.runtimes.Silverlight=b.addRuntime("silverlight",{init:function(j,k){var h,f="",g=j.settings.filters,e;if(!c("2.0.31005.0")){k({success:false});return}a[j.id]=j;h=document.createElement("div");h.id=j.id+"_silverlight_container";b.extend(h.style,{position:"absolute",top:"0",background:j.settings.silverlight_bgcolor||"transparent",width:"100px",height:"100px",opacity:0.01});h.className="plupload_silverlight";document.body.appendChild(h);for(e=0;e<g.length;e++){f+=(f!=""?"|":"")+g[e].title+" | *."+g[e].extensions.replace(/,/g,";*.")}h.innerHTML='<object id="'+j.id+'_silverlight" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%"><param name="source" value="'+j.settings.silverlight_xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="initParams" value="id='+j.id+",filter="+f+'"/><param name="onerror" value="onSilverlightError" /></object>';function d(){return document.getElementById(j.id+"_silverlight").content.Upload}j.bind("Silverlight:Init",function(){var i,l={};j.bind("Silverlight:StartSelectFiles",function(m){i=[]});j.bind("Silverlight:SelectFile",function(m,p,n,o){var q;q=b.guid();l[q]=p;l[p]=q;i.push(new b.File(q,n,o))});j.bind("Silverlight:SelectSuccessful",function(){j.trigger("FilesAdded",i)});j.bind("Silverlight:UploadFileProgress",function(m,q,n,p){var o=m.getFile(l[q]);o.size=p;o.loaded=n;m.trigger("UploadProgress",o)});j.bind("Refresh",function(m){var n,o;n=document.getElementById(m.settings.browse_button);o=b.getPos(n);b.extend(document.getElementById(m.id+"_silverlight_container").style,{top:o.y+"px",left:o.x+"px",width:n.clientWidth+"px",height:n.clientHeight+"px"})});j.bind("Silverlight:UploadChunkSuccessful",function(m,p,n,s,r){var q,o=m.getFile(l[p]);q={file:o,chunk:n,chunks:s,response:r};m.trigger("ChunkUploaded",q);if(q.cancelled){d().CancelUpload();o.status=b.FAILED;m.trigger("FileUploaded",o);return}});j.bind("Silverlight:UploadSuccessful",function(m,o){var n=m.getFile(l[o]);n.status=b.DONE;m.trigger("FileUploaded",n)});j.bind("FilesRemoved",function(m,o){var n;for(n=0;n<o.length;n++){d().RemoveFile(l[o[n].id])}});j.bind("UploadFile",function(m,o){var n=m.settings.url;n+=(n.indexOf("?")==-1?"?":"&")+"name="+escape(o.target_name||o.name);d().UploadFile(l[o.id],n,m.settings.chunk_size,m.settings.image_width,m.settings.image_height,m.settings.image_quality)});k({success:true})})}})})(plupload);(function(c){var a={};function b(){var d;try{d=navigator.plugins["Shockwave Flash"];d=d.description}catch(e){try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(e){d="0.0"}}d=d.match(/\d+/g);return parseFloat(d[0]+"."+d[1])}c.flash={trigger:function(f,d,e){setTimeout(function(){var j=a[f],h,g;if(j){j.trigger("Flash:"+d,e)}},0)}};c.runtimes.Flash=c.addRuntime("flash",{init:function(f,k){var j,e,g,d,l=0;if(b()<10){k({success:false});return}a[f.id]=f;j=document.getElementById(f.settings.browse_button);e=document.createElement("div");e.id=f.id+"_flash_container";c.extend(e.style,{position:"absolute",top:"0px",background:f.settings.flash_bgcolor||"transparent",width:"100%",height:"100%"});e.className="plupload_flash";document.body.appendChild(e);g="id="+escape(f.id);e.innerHTML='<object id="'+f.id+'_flash" width="100%" height="100%" style="outline:0" type="application/x-shockwave-flash" data="'+f.settings.flash_swf_url+'"><param name="movie" value="'+f.settings.flash_swf_url+'" /><param name="flashvars" value="'+g+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';function i(){return document.getElementById(f.id+"_flash")}function h(){if(l++>5000){k({success:false});return}if(!d){setTimeout(h,1)}}h();j=e=null;f.bind("Flash:Init",function(){var o={},m,n=f.settings.filters;d=true;for(m=0;m<n.length;m++){n[m].extensions="*."+n[m].extensions.replace(/,/g,";*.")}i().setFileFilters(n,f.settings.multi_selection);f.bind("UploadFile",function(p,r){var s=p.settings,q=s.url;q+=(q.indexOf("?")==-1?"?":"&")+"name="+escape(r.target_name||r.name);i().uploadFile(o[r.id],q,s.chunk_size,s.image_width,s.image_height,s.image_quality)});f.bind("Flash:UploadProcess",function(q,p){var r=q.getFile(o[p.id]);r.loaded=p.loaded;r.size=p.size;q.trigger("UploadProgress",r)});f.bind("Flash:UploadChunkComplete",function(p,r){var s,q=p.getFile(o[r.id]);s={file:q,chunk:r.chunk,chunks:r.chunks,response:r.text};p.trigger("ChunkUploaded",s);if(s.cancelled){i().cancelUpload();q.status=c.FAILED;p.trigger("FileUploaded",q);return}});f.bind("Flash:UploadComplete",function(q,p){var r=q.getFile(o[p.id]);r.status=c.DONE;q.trigger("FileUploaded",r)});f.bind("Flash:SelectFiles",function(p,s){var r,q,t=[],u;for(q=0;q<s.length;q++){r=s[q];u=c.guid();o[u]=r.id;o[r.id]=u;t.push(new c.File(u,r.name,r.size))}f.trigger("FilesAdded",t)});f.bind("QueueChanged",function(p){f.refresh()});f.bind("FilesRemoved",function(p,r){var q;for(q=0;q<r.length;q++){i().removeFile(o[r[q].id])}});f.bind("StateChanged",function(p){f.refresh()});f.bind("Refresh",function(p){var q,r;q=document.getElementById(p.settings.browse_button);r=c.getPos(q);c.extend(document.getElementById(p.id+"_flash_container").style,{top:r.y+"px",left:r.x+"px",width:q.clientWidth+"px",height:q.clientHeight+"px"})});k({success:true})})}})})(plupload);(function(a){var b=true,c=false;a.runtimes.BrowserPlus=a.addRuntime("browserplus",{init:function(i,l){var f=window.BrowserPlus,e={},k,j,h=i.settings;k=h.image_width;j=h.image_height;function d(q){var p,o,m=[],n,r;for(o=0;o<q.length;o++){n=q[o];r=a.guid();e[r]=n;m.push(new a.File(r,n.name,n.size))}if(o){i.trigger("FilesAdded",m)}}if(f){f.init(function(n){var m=[{service:"Uploader",version:"3"},{service:"DragAndDrop",version:"1"},{service:"FileBrowse",version:"1"}];if(k||j){m.push({service:"ImageAlter",version:"4"})}if(n.success){f.require({services:m},function(){if(n.success){g()}else{l()}})}else{l()}})}else{l()}function g(){i.bind("PostInit",function(){var p,n=h.drop_element,r=i.id+"_droptarget",m=document.getElementById(n),o;if(m){function s(u,t){f.DragAndDrop.AddDropTarget({id:u},function(v){f.DragAndDrop.AttachCallbacks({id:u,hover:function(w){if(!w&&t){t()}},drop:function(w){if(t){t()}d(w)}},function(){})})}if(document.attachEvent&&(/MSIE/gi).test(navigator.userAgent)){p=document.createElement("div");p.setAttribute("id",r);a.extend(p.style,{position:"absolute",top:"-1000px",background:"red",filter:"alpha(opacity=0)",opacity:0});document.body.appendChild(p);a.addEvent(m,"dragenter",function(u){var t,v;t=document.getElementById(n);v=a.getPos(t);a.extend(document.getElementById(r).style,{top:v.y+"px",left:v.x+"px",width:t.offsetWidth+"px",height:t.offsetHeight+"px"})});function q(){document.getElementById(r).style.top="-1000px"}s(r,q)}else{s(n)}a.addEvent(document.getElementById(h.browse_button),"click",function(y){var w=[],u,t,x=h.filters,v;y.preventDefault();for(u=0;u<x.length;u++){v=x[u].extensions.split(",");for(t=0;t<v.length;t++){w.push(a.mimeTypes[v[t]])}}f.FileBrowse.OpenBrowseDialog({mimeTypes:w},function(z){if(z.success){d(z.value)}})});m=dropTarget=0}});i.bind("UploadFile",function(m,o){var n=m.settings.url,q=e[o.id];function p(r){o.size=r.size;f.Uploader.upload({url:n+(n.indexOf("?")==-1?"?":"&")+"&multipart=true&name="+escape(o.target_name||o.name),files:{file:r},cookies:document.cookies,progressCallback:function(s){o.loaded=s.fileSent;m.trigger("UploadProgress",o)}},function(s){if(s.success){o.status=a.DONE;m.trigger("FileUploaded",o)}})}if(/\.(png|jpg|jpeg)$/i.test(o.name)&&(k||j)){BrowserPlus.ImageAlter.transform({file:q,quality:m.settings.image_quality,actions:[{scale:{maxwidth:k,maxheight:j}}]},function(r){if(r.success){p(r.value.file)}})}else{p(q)}});i.features={dragdrop:b,jpgresize:b,pngresize:b,chunks:c};l({success:b})}}})})(plupload);(function(b){var c=true;function a(i,l,j,d,k){var f,e,h,g;f=document.createElement("canvas");f.style.display="none";document.body.appendChild(f);e=f.getContext("2d");h=new Image();h.onload=function(){var o,m,n;scale=Math.min(l/h.width,j/h.height);if(scale<1){o=Math.round(h.width*scale);m=Math.round(h.height*scale)}else{o=h.width;m=h.height}f.width=o;f.height=m;e.drawImage(h,0,0,o,m);g=f.toDataURL(d);g=g.substring(g.indexOf("base64,")+7);g=atob(g);f.parentNode.removeChild(f);k({success:true,data:g})};h.src=i}b.runtimes.Html5=b.addRuntime("html5",{init:function(h,i){var d={},f;function g(m){var k,j,l=[],n;for(j=0;j<m.length;j++){k=m[j];n=b.guid();d[n]=k;l.push(new b.File(n,k.fileName,k.fileSize))}h.trigger("FilesAdded",l)}function e(){var j;if(window.XMLHttpRequest){j=new XMLHttpRequest();return !!(j.sendAsBinary||j.upload)}return false}if(!e()){i({success:false});return}h.bind("Init",function(k){var q,j=[],l,p,o=k.settings.filters,n,m;q=document.createElement("div");q.id=k.id+"_html5_container";for(l=0;l<o.length;l++){n=o[l].extensions.split(/,/);for(p=0;p<n.length;p++){m=b.mimeTypes[n[p]];if(m){j.push(m)}}}b.extend(q.style,{position:"absolute",background:h.settings.html5_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",opacity:0});q.className="plupload_html5";document.body.appendChild(q);q.innerHTML='<input id="'+h.id+'_html5" style="width:100%;" type="file" accept="'+j.join(",")+'" '+(h.settings.multi_selection?'multiple="multiple"':"")+" />";document.getElementById(h.id+"_html5").onchange=function(){g(this.files);this.value=""}});h.bind("PostInit",function(){var j=document.getElementById(h.settings.drop_element);if(j){b.addEvent(j,"dragover",function(k){k.preventDefault()});b.addEvent(j,"drop",function(l){var k=l.dataTransfer;if(k&&k.files){g(k.files)}l.preventDefault()})}});h.bind("Refresh",function(j){var k,l;k=document.getElementById(h.settings.browse_button);l=b.getPos(k);b.extend(document.getElementById(h.id+"_html5_container").style,{top:l.y+"px",left:l.x+"px",width:k.offsetWidth+"px",height:k.offsetHeight+"px"})});h.bind("UploadFile",function(k,o){var q=new XMLHttpRequest(),n,m=k.settings.url,l,j,p;if(o.status==b.DONE||o.status==b.FAILED||k.state==b.STOPPED){return}if(n=q.upload){n.onload=function(){o.status=b.DONE;k.trigger("FileUploaded",o)};n.onprogress=function(r){o.loaded=r.loaded;k.trigger("UploadProgress",o)}}q.onreadystatechange=function(){if(q.readyState==4){o.status=b.DONE;o.loaded=o.size;k.trigger("UploadProgress",o);k.trigger("FileUploaded",o)}};q.open("post",m+(m.indexOf("?")==-1?"?":"&")+"name="+escape(o.target_name||o.name),true);q.setRequestHeader("Content-Type","application/octet-stream");p=d[o.id];if(q.sendAsBinary){l=k.settings.image_width;j=k.settings.image_height;if(/\.(png|jpg|jpeg)$/i.test(o.name)&&(l||j)){a(p.getAsDataURL(),l,j,/\.png$/i.test(o.name)?"image/png":"image/jpeg",function(r){if(r.success){o.size=r.data.length;q.sendAsBinary(r.data)}else{q.sendAsBinary(p.getAsBinary())}})}else{q.sendAsBinary(p.getAsBinary())}}else{q.send(p)}});f=!!(File&&File.prototype.getAsDataURL);h.features={dragdrop:window.mozInnerScreenX!==undefined,jpgresize:f,pngresize:f};i({success:c})}})})(plupload);